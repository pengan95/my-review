# Redis知识点集合

### 大纲
1. redis数据类型
2. redis类型常见应用场景
3. redis集群知识

[predis和phpredis的区别](https://segmentfault.com/q/1010000008848852)
[api并发调优过程](https://juejin.im/post/6844903849132556296)
[keys / scan 命令用来获取指定前缀的key](http://jinguoxing.github.io/redis/2018/09/04/redis-scan/)

### 类型
1. string (set -> nx ex px) 并发锁 
2. list 可以做消息队列 一致性要求不高
3. set 集合 可以做一些交集并集的运算
4. sort set 有序集合 
5. hash 用来存储对象数据 减少程序的解析操作
6. *pub/sub 订阅*
7. *hyperloglog*
8. *bitmap*
9. *stream*

## redis是单线程的？ 为什么处理快？
    redis单线程是指处理网络请求是单线程的，其他持久化的处理是调用新的线程/进程处理

## redis 慢查询slowlog 是一个定长队列（128） 可以设定慢的标准，多少毫秒 默认10ms， 生产环境1ms ,这样吞吐量在1000 qps
（1）slowlog-max-len配置建议：线上建议调大慢查询列表，记录慢查询时Redis会对长命令做截断操作，并不会占用大量内存。

　　增大慢查询列表可以减缓慢查询被剔除的可能。

（2）slowlog-log-slower-than配置建议：默认值超过10毫秒判定为慢查询，需要根据Redis并发量调整该值。

　　由于Redis采用单线程响应命令，对于高流量的场景，如果命令执行时间在1毫秒以上，那么Redis最多可以支撑OPS不到1000，因此对于高OPS的场景的Redis建议设置1毫秒。

（3）慢查询只记录命令执行时间，并不包括命令排队和网络传输时间。因此客户端执行命令的时间会大于命令实际执行的时间。

　　因为命令执行排队机制，慢查询会导致其他命令级联阻塞，因此当客户端出现请求超时，

　　需要检查该时间点是否有对应的慢查询，从而分析出是否为慢查询导致的命令级联阻塞。

（4）由于慢查询日志是一个先进先出的队列，也就是说如果慢查询比较多的情况下，可能会丢失部分慢查询命令，

　　为了防止这种情况发生，可以定期执行slowlog get命令将慢查询日志持久化到其他存储中（例如，MySQL），

　　然后可以制作出可视化界面进行查询。