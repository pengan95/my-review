## 自我介绍
我叫黄朋安，2017年9月毕业于河南大学软件工程专业，学历是本科，毕业后进入上海美锴信息技术有限公司，在公司担任PHP开发工程师一职，参与Extrabux返利网站的构建和完善，主要负责提现，消息推送，商家维护等业务以及配合运营团队的营销活动进行代码开发。

## 介绍一下你的项目，并说说你觉得项目中的难点

### 关键词
1. 业务拆分为服务
2. 基于jwt认证的http api
3. Mysql 事务 排他锁
4. redis 互斥锁 hash结构共享数据
5. SQS 消息队列
6. PHP PDO实现Dao类 orm封装数据库操作Trait实现多继承一些共享方法 比如实现的orm对象中都有的create modified字段的getter setter
7. Thinkphp3.2 behavior  vue.js bootstrap前端的开发
6. yeild 生成器和迭代器

Extrabux.com返利网站由前台站点以及后台管理模块组成，架构上拆分了用户提现，用户钱包，用户奖励以及用户卡券四个业务模块为四个服务，服务之间基于jwt认证的api进行数据交互。我负责提现服务系统的开发，数据库采用Mysql, 用redis实现并发锁，一个用户在同一时间只能有一个提现申请成功，同时用redis实现钱包服务和提现申请操作的一些数据共享，比如汇率信息。
对于用户提现产品的库存修改Mysql中事务排他锁保证原子性。基于AWS SQS实现的提现审核服务和消息通知服务，将跟用户提现强相关的业务解耦，用户提现成功或失败只需要发送一个消息，由后台服务获取消息异步处理。
后台工具的开发，Thinkphp框架，主要用到vue.js+bootstrap实现前台展示，tp中用到behavior实现一些钩子，

### 项目的细节
1. jwt认证问题，jwt数据结构 header 指定加密算法 none  playload 一些必须的参数，提现项目中传递了用户余额，汇率的缓存key，token过期时间 sign 前面两个参数的base64encode拼接（base64encode一些特殊字符的转换=之类的）通过上面的加密算法进行加密再进行拼接。
2. jwt存在的安全问题  
    1. 在没有校验sign值的前提下对有效负载使用
    2. 在playload添加请求时间戳防止被中间人攻击
3. redis简单的互斥锁，set nx ex 原子操作
4. 这个可以放在自己工作之余 看了rpc框架的内容的想法。提现性能的问题，目前由于网站用户规模不大，每天提现的用户也仅在100人一下，不过用户提现操作中，涉及到三个服务之间的调用，


### 项目难点或者问题

**1. 用户提现如何保证提现防止用户重复提交以及和钱包系统共享数据的方案**
1. 前台js做了防重复点击
2. 因为系统中
3. 需求的不稳定，为了确保未来可拓展性，在代码设计上思考了很多方案，
4. 

**2. 常驻脚本PDO连接内存溢出问题**

> 参考连接 
> 1. https://blog.csdn.net/LJFPHP/article/details/105105606
> 2. https://segmentfault.com/q/1010000004670407
> 3. https://www.cnblogs.com/liuyublog/p/11585865.html


    项目中有一个常驻脚本来消耗队列的程序，脚本执行一段时间后就报错Fatel Error异常退出，日志记录的错误是内存溢出 但是当时查看了脚本代码基本判定只有Mysql插询的Mysql 

***引申问题***
1. 垃圾回收机制
2. 错误处理 自动重连机制的实现 PHP Exception catch不到warning级别的错误 set_error_handle 函数来获取

## 补充项目

目前正在做的项目，卡券服务的开发并接入到用户提现业务中，卡券服务主要实现就是发放，用户领取，用户使用，配置卡券

卡券的属性 

## 